---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const entries = await getCollection('alternatives');
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { data } = entry;
const { Content } = await entry.render();

const nicheLabel = data.niche.replace(/-/g, ' ').replace(/\b\w/g, (c: string) => c.toUpperCase());
---

<BaseLayout
  title={data.title + ' â€” PickStack.ai'}
  description={data.excerpt}
  ogType="article"
  publishedAt={data.publishDate}
  updatedAt={data.updatedAt}
  author={data.author}
>
  <div style="background:white; min-height:60vh;">
    <article style="max-width:820px; margin:0 auto; padding:40px 24px 72px;">

      <!-- Breadcrumb -->
      <nav style="margin-bottom:24px; font-size:13px;">
        <ol style="display:flex; align-items:center; gap:8px; color:#6B7280; list-style:none; padding:0; margin:0; flex-wrap:wrap;">
          <li><a href="/" style="color:var(--color-link); text-decoration:none;">Home</a></li>
          <li style="color:#D1D5DB">/</li>
          <li><a href="/alternatives" style="color:var(--color-link); text-decoration:none;">Alternatives</a></li>
          <li style="color:#D1D5DB">/</li>
          <li><a href={`/${data.niche}`} style="color:var(--color-link); text-decoration:none;">{nicheLabel}</a></li>
          <li style="color:#D1D5DB">/</li>
          <li style="color:#111827; font-weight:500;">{data.tool} Alternatives</li>
        </ol>
      </nav>

      <!-- Header -->
      <header style="margin-bottom:32px; padding-bottom:28px; border-bottom:1px solid #E5E7EB;">
        <div style="display:inline-block; font-size:11px; font-weight:700; letter-spacing:1px; text-transform:uppercase; color:var(--color-primary-muted); background:#F5F3FF; border:1px solid #DDD6FE; padding:4px 10px; border-radius:4px; margin-bottom:14px;">
          ðŸ”„ Alternatives Guide Â· {nicheLabel}
        </div>
        <h1 style="font-size:2.25rem; font-weight:800; color:var(--color-primary); margin-bottom:14px; letter-spacing:-0.02em; line-height:1.2;">
          {data.title}
        </h1>
        <p style="font-size:1.1rem; color:#4B5563; margin-bottom:16px; line-height:1.6;">{data.excerpt}</p>
        <div style="display:flex; align-items:center; gap:12px; font-size:13px; color:#9CA3AF; flex-wrap:wrap;">
          <span>By {data.author}</span>
          <span>Â·</span>
          <time datetime={data.publishDate.toISOString()}>
            {data.publishDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
          </time>
          {data.updatedAt && (
            <>
              <span>Â·</span>
              <span>Updated {data.updatedAt.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</span>
            </>
          )}
        </div>
      </header>

      <!-- Alternative Tool Cards -->
      <div style="margin-bottom:40px;">
        <h2 style="font-size:1.25rem; font-weight:700; color:var(--color-primary); margin-bottom:16px;">
          Top {data.alternatives.length} Alternatives to {data.tool}
        </h2>
        <div style="display:flex; flex-direction:column; gap:12px;">
          {data.alternatives.map((alt: {name: string; slug: string; bestFor: string; rating: number; affiliateUrl?: string}, i: number) => (
            <div style="display:flex; align-items:center; gap:16px; border:1px solid #E5E7EB; border-radius:10px; padding:16px 18px; background:white;">
              <div style="font-size:1.25rem; font-weight:900; color:var(--color-primary-muted); min-width:28px;">#{i + 1}</div>
              <div style="flex:1; min-width:0;">
                <div style="font-size:15px; font-weight:700; color:var(--color-primary); margin-bottom:3px;">{alt.name}</div>
                <div style="font-size:13px; color:#6B7280;">Best for: {alt.bestFor}</div>
              </div>
              <div style="display:flex; align-items:center; gap:12px; flex-shrink:0;">
                <div style="text-align:center;">
                  <div style="font-size:1.1rem; font-weight:800; color:var(--color-primary);">{alt.rating.toFixed(1)}</div>
                  <div style="font-size:11px; color:#9CA3AF;">/ 5</div>
                </div>
                {alt.affiliateUrl && (
                  <a href={alt.affiliateUrl} style="background:var(--color-cta); color:var(--color-primary); font-size:13px; font-weight:700; padding:8px 14px; border-radius:6px; text-decoration:none; white-space:nowrap;">
                    Try Free â†’
                  </a>
                )}
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Article Content -->
      <div class="prose">
        <Content />
      </div>

      <!-- Affiliate Disclosure -->
      <aside style="margin-top:48px; padding:16px 20px; background:#F9FAFB; border:1px solid #E5E7EB; border-left:4px solid var(--color-primary-muted); border-radius:0 8px 8px 0; font-size:13px; color:#6B7280;">
        <strong style="color:#374151;">Disclosure:</strong> Some links in this article are affiliate links. We may earn a commission if you make a purchase, at no extra cost to you.
        <a href="/methodology" style="color:var(--color-link);">Learn about our methodology â†’</a>
      </aside>

    </article>
  </div>
</BaseLayout>
